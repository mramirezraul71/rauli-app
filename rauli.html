<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>RAULI Â· PanaderÃ­a & DulcerÃ­a</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- PWA -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#1f3c88" />
  <link rel="icon" href="icon-192.png" />

  <style>
    :root{
      --blue:#1f3c88;
      --blue2:#2d5be3;
      --yellow:#ffd43b;
      --yellow2:#ffb703;
      --bg:#0b1220;
      --panel:#121c33;
      --text:#ffd43b;
      --muted:#c7d2ff;
      --danger:#ff6b6b;
      --ok:#51cf66;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,Segoe UI,Roboto,Arial;
      background:linear-gradient(180deg,#0b1220,#0e1630);
      color:var(--text);
    }
    header{
      background:linear-gradient(90deg,var(--blue),var(--blue2));
      padding:14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      box-shadow:0 4px 20px rgba(0,0,0,.4);
    }
    header h1{
      margin:0;
      font-size:20px;
      letter-spacing:1px;
    }
    header span{
      font-size:13px;
      color:#fff;
      opacity:.9;
    }
    .status{
      display:flex;
      gap:10px;
      align-items:center;
    }
    .chip{
      background:rgba(0,0,0,.25);
      padding:6px 10px;
      border-radius:20px;
      font-size:12px;
      display:flex;
      gap:6px;
      align-items:center;
      color:#fff;
    }
    .dot{
      width:8px;
      height:8px;
      border-radius:50%;
    }
    .on{background:#51cf66}
    .off{background:#ff6b6b}

    main{
      padding:16px;
      padding-bottom:110px;
      max-width:1200px;
      margin:auto;
    }

    .panel{
      background:var(--panel);
      border-radius:16px;
      padding:16px;
      margin-bottom:16px;
      box-shadow:0 10px 40px rgba(0,0,0,.4);
    }

    h2{
      margin:0 0 10px 0;
      font-size:18px;
      color:var(--yellow2);
    }
    p{margin:6px 0;color:var(--muted)}

    .grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
      gap:14px;
    }
    .card{
      background:#0e1730;
      border-radius:14px;
      padding:14px;
      border:1px solid rgba(255,255,255,.08);
    }
    .card b{color:var(--yellow2)}

    input,select,textarea{
      width:100%;
      padding:10px;
      border-radius:10px;
      border:none;
      background:#0b1328;
      color:var(--yellow);
      margin-top:6px;
    }

    button{
      padding:10px 14px;
      border:none;
      border-radius:12px;
      background:linear-gradient(90deg,var(--yellow),var(--yellow2));
      color:#000;
      font-weight:700;
      cursor:pointer;
      margin-top:10px;
    }
    button.secondary{
      background:#1c2a55;
      color:var(--yellow);
    }
    button.danger{
      background:var(--danger);
      color:#fff;
    }

    nav{
      position:fixed;
      bottom:0;
      left:0;
      right:0;
      background:#0b1220;
      border-top:1px solid rgba(255,255,255,.1);
      display:flex;
      justify-content:space-around;
      padding:10px 0;
    }
    nav button{
      background:none;
      color:var(--yellow);
      font-size:12px;
      margin:0;
    }

    .hidden{display:none}

    footer{
      text-align:center;
      font-size:11px;
      color:var(--muted);
      margin-top:20px;
    }
  </style>
</head>

<body>

<header>
  <div>
    <h1>RAULI</h1>
    <span>PanaderÃ­a & DulcerÃ­a Â· Asistente Digital</span>
  </div>
  <div class="status">
    <div class="chip" id="connChip">
      <div class="dot off" id="connDot"></div>
      <span id="connText">Offline</span>
    </div>
    <div class="chip" id="userChip">ðŸ‘¤ â€”</div>
  </div>
</header>

<main>

  <!-- INICIO -->
  <section id="secInicio" class="panel">
    <h2>ðŸ¤– Asistente RAULI</h2>
    <p id="saludo">Cargando saludoâ€¦</p>

    <textarea id="assistantInput" placeholder="Ej: Venta $120 efectivo / Harina bajo mÃ­nimo / Cierre de caja"></textarea>
    <button id="btnIA">Enviar al asistente</button>

    <div class="panel" style="margin-top:12px">
      <h2>Mensajes</h2>
      <div id="chatBox"></div>
    </div>
  </section>

  <!-- FINANZAS -->
  <section id="secFinanzas" class="panel hidden">
    <h2>ðŸ’¼ Fondo Â· NÃ³mina Â· AmortizaciÃ³n</h2>

    <div class="grid">
      <div class="card">
        <b>Fondo Operativo</b>
        <p>Objetivo</p>
        <div id="fundTarget">$0</div>
        <p>Balance actual</p>
        <div id="fundBalance">$0</div>
      </div>

      <div class="card">
        <b>Hoy vas ganando</b>
        <div id="todayEarnings">$0</div>
      </div>

      <div class="card">
        <b>AmortizaciÃ³n</b>
        <p>Mes actual</p>
        <div id="amortMonth">$0</div>
        <p>Acumulado</p>
        <div id="amortTotal">$0</div>
      </div>
    </div>

    <div class="panel" style="margin-top:12px">
      <h2>ðŸ“Š GrÃ¡fico</h2>
      <canvas id="financeChart" height="120"></canvas>
    </div>
  </section>

  <!-- PRODUCCIÃ“N -->
  <section id="secProduccion" class="panel hidden">
    <h2>ðŸ¥– ProducciÃ³n</h2>
    <p>Registro de lotes y libras elaboradas</p>
    <input id="prodProducto" placeholder="Producto" />
    <input id="prodLbs" type="number" placeholder="Libras producidas" />
    <button id="btnProd">Guardar lote</button>
  </section>

  <!-- VENTAS -->
  <section id="secVentas" class="panel hidden">
    <h2>ðŸ§¾ Ventas</h2>
    <input id="ventaProducto" placeholder="Producto" />
    <input id="ventaUnidades" type="number" placeholder="Unidades" />
    <input id="ventaTotal" type="number" placeholder="Total $" />
    <select id="ventaMetodo">
      <option value="efectivo">Efectivo</option>
      <option value="transferencia">Transferencia</option>
      <option value="tarjeta">Tarjeta</option>
    </select>
    <button id="btnVenta">Guardar venta</button>
  </section>

</main>

<nav>
  <button onclick="show('secInicio')">Inicio</button>
  <button onclick="show('secFinanzas')">Finanzas</button>
  <button onclick="show('secProduccion')">ProducciÃ³n</button>
  <button onclick="show('secVentas')">Ventas</button>
</nav>

<footer>
  RAULI Â· Sistema offline-first Â· Autor del prototipo: ChatGPT
</footer>

<script>
  function show(id){
    document.querySelectorAll("main section").forEach(s=>s.classList.add("hidden"));
    document.getElementById(id).classList.remove("hidden");
  }

  function updateConn(){
    const online = navigator.onLine;
    document.getElementById("connDot").className = "dot " + (online ? "on":"off");
    document.getElementById("connText").textContent = online ? "Online":"Offline";
  }
  window.addEventListener("online",updateConn);
  window.addEventListener("offline",updateConn);
  updateConn();
</script>

<script type="module" src="rauli-core.js"></script>
<script type="module" src="rauli-assistant.js"></script>

</body>
</html>
